/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/**
 * @license RequireJS text 2.0.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("settings",[],function(){var e=1.5,t={width:960/e,height:720/e};return{factor:e,renderWindowSize:t,renderAspectRatio:t.width/t.height,portalDepth:36,portalSize:100,worldSize:{width:60,height:60},warpHoleColumns:11,warpHoleRows:11,frameSize:9.09,FLARThreshold:64}}),define("domReady",[],function(){function u(e){var t;for(t=0;t<e.length;t+=1)e[t](s)}function a(){var e=o;i&&e.length&&(o=[],u(e))}function f(){i||(i=!0,n&&clearInterval(n),a())}function c(e){return i?e(s):o.push(e),c}var e,t,n,r=typeof window!="undefined"&&window.document,i=!r,s=r?document:null,o=[];if(r){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),t=document.createElement("div");try{e=window.frameElement===null}catch(l){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll(),f()}catch(e){}},30))}document.readyState==="complete"&&f()}return c.version="2.0.1",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),define("display",["domReady!","./settings"],function(e,t){var n=document.getElementById("display"),r=new THREE.WebGLRenderer({canvas:n});r.setSize(t.renderWindowSize.width,t.renderWindowSize.height),r.autoClear=!1;var i=function(){r.context.colorMask(!1,!1,!1,!1),r.context.depthMask(!0)},s=function(){r.context.colorMask(!0,!0,!0,!0)},o={mouseListener:undefined,beginOccluderRendering:i,endOccluderRendering:s,renderer:r},u=function(e){var t=e.pageX-r.domElement.offsetLeft,n=e.pageY+r.domElement.offsetTop,i=t/r.domElement.width*2-1,s=-(n/r.domElement.height)*2+1;return new THREE.Vector3(i,s,1)},a=function(e){e.preventDefault(),o.mouseListener.onMouseMove.apply(o.mouseListener,[u(e)])},f=function(e){e.preventDefault(),o.mouseListener.onMouseDown.apply(o.mouseListener,[u(e)])},l=function(e){e.preventDefault(),o.mouseListener.onMouseUp.apply(o.mouseListener,[u(e)])};return r.domElement.addEventListener("mousemove",a,!1),r.domElement.addEventListener("mousedown",f,!1),r.domElement.addEventListener("mouseup",l,!1),o.toScreenXY=function(e,t){var r=n.width,i=n.height,s=r/2,o=i/2,u=new THREE.Projector,a=u.projectVector(e.clone(),t);return a.x=a.x*s+s,a.y=-(a.y*o)+o,a},o}),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.5",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+(s.ext?"."+s.ext:""),h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("ï»¿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);c.onXhr&&c.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText))},s.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("text!planes.json",[],function(){return'{"warpHoles":{"2":{"id":2,"x":23,"y":32,"active":true},"8":{"id":8,"x":48,"y":52,"active":true},"4":{"id":4,"x":7,"y":35,"active":true}},"islands":{"0":{"x":0,"y":0,"width":60,"height":60,"walls":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,1,1,1,11,11,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,1,1,11,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,7,7,7,5,5,7,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,7,3,5,7,7,5,5,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,11,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,7,7,7,7,7,5,6,7,7,5,5,7,6,7,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,7,5,7,7,6,5,5,6,6,3,5,7,6,5,5,5,5,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,1,1,0,0,0,0,0,0,7,7,5,7,6,5,6,5,5,5,6,5,7,7,7,5,5,5,5,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,11,11,11,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,7,7,7,5,5,6,5,5,6,3,3,5,6,5,5,5,5,5,7,7,7,7,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,11,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,7,7,5,7,5,5,5,5,3,3,3,3,3,3,3,5,5,5,6,5,5,7,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,7,5,5,6,6,3,5,3,3,6,6,6,3,3,3,15,6,5,5,5,7,7,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,7,5,5,5,6,3,6,3,6,6,3,3,3,15,15,15,3,6,7,7,7,7,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,7,7,7,5,5,3,6,3,6,6,3,15,15,15,3,6,6,3,7,7,7,7,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,7,5,5,5,5,3,15,15,6,3,3,15,15,3,6,6,7,7,7,7,7,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,7,5,3,5,5,15,15,15,6,6,6,6,15,3,6,6,7,5,5,5,7,7,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,7,5,5,3,3,15,15,15,3,6,6,15,15,3,3,6,7,7,7,5,5,7,0,0,0,0,0,0,0,0,0,0,1,1,1,11,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,7,7,7,7,5,3,15,15,15,6,15,15,3,3,5,5,6,7,5,5,7,7,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,7,7,5,6,5,6,15,15,15,7,3,3,3,5,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,7,7,7,7,7,7,7,15,15,7,7,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,11,11,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,11,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,7,14,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,7,7,5,7,7,7,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,15,15,15,15,15,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,0,0,0,0,0,7,7,5,6,6,6,5,5,5,5,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,15,0,0,0,15,15,0,0,0,0,1,1,1,0,1,1,1,1,1,1,11,0,0,0,7,7,7,7,5,6,6,6,5,5,5,5,5,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,15,0,0,0,15,15,15,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,0,7,5,5,6,6,6,5,5,5,5,5,5,5,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,15,15,15,0,0,0,0,0,15,15,15,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,7,5,14,6,14,5,5,5,14,14,5,5,5,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,15,0,15,15,0,13,13,0,0,0,0,0,1,1,1,0,0,0,7,5,5,6,3,5,7,3,5,8,14,14,5,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,15,0,1,15,15,13,0,0,0,0,0,0,1,1,1,0,0,7,7,3,5,6,6,14,7,6,7,14,7,5,5,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,15,0,0,0,0,0,0,0,15,15,15,0,1,1,0,13,13,0,0,0,0,1,1,1,0,0,0,7,5,5,5,6,5,5,5,5,7,8,7,5,14,6,6,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,13,13,13,0,0,0,0,0,15,15,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,5,5,5,6,5,15,15,5,7,7,5,5,8,14,6,6,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,13,0,13,0,0,0,0,0,15,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,0,0,0,0,3,3,14,6,5,5,15,5,5,3,3,5,14,14,14,6,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,7,7,6,5,5,15,15,5,3,7,5,5,7,14,6,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,1,0,0,0,0,0,0,0,7,6,5,5,15,7,3,3,3,3,5,3,6,6,6,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,6,6,5,5,15,3,7,15,3,3,5,5,14,6,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,6,5,5,5,15,15,3,15,3,3,3,6,6,6,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,6,6,3,5,7,15,15,3,3,14,6,6,6,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,6,6,3,15,15,7,15,3,7,6,6,6,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,6,6,6,15,15,15,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,11,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,11,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,15,0,0,0,0,13,0,13,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,15,15,0,15,15,15,15,0,13,13,13,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,0,0,0,0,0,0,0,15,0,0,15,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,15,15,0,0,0,0,0,0,0,0,15,15,15,15,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,11,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,11,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"items":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"filterables":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}} '}),define("planes",["text!planes.json"],function(e){var t=0,n=function(e){return e.map(function(e){return{name:e>0?t++:undefined,type:e}})},r=JSON.parse(e),i=r.islands,s=r.warpHoles,o={};for(var u in i){var a=i[u],f={id:u,width:a.width,height:a.height,walls:n(a.walls),items:n(a.items),filterables:n(a.filterables)};o[u]=f}var l=function(){return JSON.stringify({warpHoles:s,islands:i})};return{toJSON:l,islands:i,warpHoles:s,getIsland:function(e){return o[e]}}}),define("inventory",[],function(){var e={1:function(){return{id:1,name:"coin"}},2:function(){return{id:2,name:"shades"}},3:function(){return{id:3,name:"spacesuit"}},4:function(){return{id:4,name:"kicks"}},5:function(){return{id:5,name:"note"}}},t=function(t){var n=e[t];return n?n():undefined};return{getItem:t}}),define("hud",[],function(){var e=[],t=function(t,n){var r=document.createElement("div");r.className="flicker",r.style.position="absolute",r.style.zIndex=1e3,r.innerHTML=n,document.getElementById("output").appendChild(r),e.push({element:r,object:t})},n=function(t){e=e.filter(function(e){return e.object.name===t.name?(document.getElementById("output").removeChild(e.element),!1):!0})},r=function(){var t=document.getElementById("output");e.forEach(function(e){t.removeChild(e.element)}),e=[]},i=function(t,n){e.forEach(function(e){var r=e.object.matrixWorld.getPosition(),i=t.toScreenXY(r,n);e.element.style.left=i.x+"px",e.element.style.top=i.y+"px"})};return{addTag:t,removeTag:n,removeAllTags:r,positionTags:i}}),define("map",["./planes","./inventory","./hud"],function(e,t,n){var r=function(e,t){var n=new THREE.Mesh(new THREE.PlaneGeometry(t.width,t.height),new THREE.MeshLambertMaterial({wireframe:!1,color:e.color,side:THREE.DoubleSide}));return n},i=function(e,t){var n=new THREE.Mesh(new THREE.PlaneGeometry(t.width,t.height),new THREE.MeshLambertMaterial({wireframe:!1,color:e.color,side:THREE.FrontSide}));return n},s=function(e){return e},o=!1,u=function(e){o=e},a=function(e){return e===2&&o?0:e},f=function(e,t){return new THREE.Mesh(new THREE.CubeGeometry(t.width/2,t.height/2,t.depth),new THREE.MeshLambertMaterial({emissive:e.color,color:e.color}))},l=function(e,t,n,r,i){var s=d.getCell(e,t,n);if(s.type===0)return undefined;var o=p[e][s.type].stack,u=o.meshGenerator(o,r);return u.matrixAutoUpdate=!1,u.name=s.name,u.description=p[e][s.type].description,u},c=function(e){for(var t in p){var n=p[t];for(var r in n){var i=n[r];h(e,i)}}},h=function(e,t){e.forEach(function(e){var n=t[e];if(n){var r={description:n.description,color:n.color,meshGenerator:n.meshGenerator,filterer:n.filterer};t.stack=n}})},p=function(){return{filterables:{2:{eye:{description:"red-invisible wall",color:8914952,meshGenerator:r,filterer:s},red:{description:"red-invisible wall",color:15658734,meshGenerator:i,filterer:a},stack:undefined}},walls:{1:{eye:{description:"impermeable wall",color:8947848,meshGenerator:r,filterer:s},stack:undefined},2:{eye:{description:"red-invisible wall",color:8914952,meshGenerator:r,filterer:s},stack:undefined},3:{eye:{description:"impermeable wall",color:13296789,meshGenerator:r,filterer:s},stack:undefined},4:{eye:{description:"impermeable wall",color:11655268,meshGenerator:r,filterer:s},stack:undefined},5:{eye:{description:"impermeable wall",color:10079283,meshGenerator:r,filterer:s},stack:undefined},6:{eye:{description:"impermeable wall",color:5098547,meshGenerator:r,filterer:s},stack:undefined},7:{eye:{description:"impermeable wall",color:3394662,meshGenerator:r,filterer:s},stack:undefined},8:{eye:{description:"impermeable wall",color:3394739,meshGenerator:r,filterer:s},stack:undefined},9:{eye:{description:"impermeable wall",color:3381708,meshGenerator:r,filterer:s},stack:undefined},10:{eye:{description:"impermeable wall",color:3362252,meshGenerator:r,filterer:s},stack:undefined},11:{eye:{description:"impermeable wall",color:11507172,meshGenerator:r,filterer:s},stack:undefined},12:{eye:{description:"impermeable wall",color:9135320,meshGenerator:r,filterer:s},stack:undefined},13:{eye:{description:"impermeable wall",color:6697932,meshGenerator:r,filterer:s},stack:undefined},14:{eye:{description:"impermeable wall",color:13415219,meshGenerator:r,filterer:s},stack:undefined},15:{eye:{description:"impermeable wall",color:13395507,meshGenerator:r,filterer:s},stack:undefined},16:{eye:{description:"impermeable wall",color:13382477,meshGenerator:r,filterer:s},stack:undefined},17:{eye:{description:"impermeable wall",color:13382553,meshGenerator:r,filterer:s},stack:undefined},18:{eye:{description:"impermeable wall",color:11744204,meshGenerator:r,filterer:s},stack:undefined}},items:{1:{eye:{description:"coin",color:248,meshGenerator:f},description:"coin",stack:undefined},2:{eye:{description:"shades",color:16253176,meshGenerator:f},description:"shades",stack:undefined},3:{eye:{description:"spacesuit",color:16316431,meshGenerator:f},description:"spacesuit",stack:undefined},4:{eye:{description:"kicks",color:8919215,meshGenerator:f},description:"kicks",stack:undefined},5:{eye:{description:"page",color:8984591,meshGenerator:f},description:"page",stack:undefined}}}}();c(["eye"]);var d=function(){var t=function(t,n,r){var i=e.getIsland(0);return i[t][r*i.width+n]},n=function(e,n,r,i){var s=t(e,n,r);s.type=i};return{planes:e.processed,getCell:t,setCell:n}}(),v=function(){var e=[],t=function(t){e.push(t)},n=function(t){e=e.filter(function(e){return e!==t})},r=function(t){e.forEach(function(e){e.removeTileObjectNamed(t.name)})},i=function(e){c(e),s()},s=function(){e.forEach(function(e){e.reRenderFilterables()})},o=function(){e.forEach(function(e){e.reRenderItems()})};return{add:t,remove:n,removeTileObjectIfPresent:r,applyFilter:i,reRenderItems:o}}(),m=function(e,t,r,i,s,o,u){var a=new THREE.Object3D;a.matrixAutoUpdate=!1;var f=s,c=o,h=e/f,p=t/c,d=.01,m=i,g={width:h,height:p,depth:d},y=m.x-Math.floor(f/2);y=y>=0?y:0;var b=m.y-Math.floor(c/2);b=b>=0?b:0;var w=function(e){return(e-m.x)*h},E=function(e){return(m.y-e)*p},S=function(){return r},x={},T=function(e){var t=x[e];t.parent.remove(t),C(e)},N=function(){var e=x.items;k=k.filter(function(e){return n.removeTag(e),!1}),e.parent.remove(e),C("items",function(e){k.push(e),n.addTag(e,e.description)})},C=function(e,t){var n=new THREE.Object3D;n.matrixAutoUpdate=!1,x[e]=n;for(var r=b;r<b+c;r++)for(var i=y;i<y+f;i++){var s=l(e,i,r,g,u);s&&(s.position.set(w(i),E(r),S()),s.updateMatrix(),n.add(s),t&&t(s))}n.updateMatrix(),a.add(n)};C("walls"),C("filterables");var k=[];C("items",function(e){k.push(e)});var L=function(e){return e.x>=y&&e.x<y+c&&e.y>=b&&e.y<b+f},A=function(e,t){return{x:w(e),y:E(t),z:S()}},O=function(e){var t=a.getChildByName(e,!0);t&&(k=k.filter(function(e){return e.name==t.name?(n.removeTag(t),!1):!0}),t.parent.remove(t))},M=function(){k.forEach(function(e){n.addTag(e,e.description)})},_=function(){k.forEach(function(e){n.removeTag(e)})},D={containsPoint:L,computePosition:A,removeTileObjectNamed:O,tileWidth:h,tileHeight:p,close:function(){_(),v.remove(this)},reRenderFilterables:function(){T("filterables")},reRenderItems:N,model:a,activate:M,deactivate:_};return v.add(D),D},g=function(e){var t=d.getCell("walls",e.x,e.y);if(t.type!==0){var n=p.walls[t.type].stack.filterer,r=n(t.type);return r===0}t=d.getCell("filterables",e.x,e.y);if(t.type!==0){var n=p.filterables[t.type].stack.filterer,r=n(t.type);return r===0}return!0},y=function(e){var n=d.getCell("items",e.x,e.y),r=t.getItem(n.type);return r&&(n.type=0,v.removeTileObjectIfPresent(n)),r},b=function(e,t){var n=d.getCell("items",e.x,e.y);n.type!==0?console.log("item already present at this location.",e.x,e.y,n.type):d.setCell("items",e.x,e.y,t.id)};return{createObject:m,getItem:y,setItem:b,isOpenPosition:g,applyFilterToMapObjects:v.applyFilter,reRenderItems:v.reRenderItems,WarpHolePoints:e.warpHoles,setShadowWorld:u}}),define("input",[],function(){var e=function(t,n,r){this.actions=n,this.timing=r?r:{expiration:55,recovery:0},this.looped=undefined,this.branch={},this.clear=function(){this.looped=!1,this.branch={}},this.getTiming=function(e){return e.expiration=this.timing.expiration,e.recovery=this.timing.recovery,e},this.get=function(e){return this.branch[e]},this.add=function(t,n,r){var i=new e(t,n,r);return this.branch[t]=i,i},this.loop=function(e){this.looped=e},this.seek=function(e){var t=this.branch[e.shift()];return t?t.seek(e):this}},t=function(){function i(){return n.getTiming(r),n.actions.forEach(function(e){a.firePlayAction.apply(a,[e])}),n.looped?n.looped:n}function s(e){if(!u)return;if(r.recovery>0)return;n=n.get(e),n?n=i():(n=t.get(e),n=n?i():t)}function o(e){}var t=new e,n=t,r=t.getTiming({}),u=!1,a=undefined;return{initialize:function(){this.reset(),u=!1},getRootAction:function(){return t},setActionDelegate:function(e){a=e},enable:function(){u=!0,this.reset()},disable:function(){u=!1},reset:function(){n=t,n.getTiming(r)},inputOn:function(e){s(e)},inputOff:function(e){o(e)},advance:function(){r.recovery>0?--r.recovery===0&&a.firePlayAction("RECOVERED"):r.expiration>0&&--r.expiration===0&&(a.firePlayAction("EXPIRED"),n=t,n.getTiming(r))}}}(),n=function(){function n(t,n){if(e[t])return;e[t]=!0,n.inputOn.apply(n,[t])}function r(t,n){e[t]&&n.inputOff.apply(n,[t]),e[t]=!1}function s(e){if(i[e])return n(i[e],t),!1;console.log("unmapped key down:",e)}function o(e){if(i[e])return r(i[e],t),!1}function u(e){if(!e)var e=window.event;return s(e.keyCode)}function a(e){if(!e)var e=window.event;return o(e.keyCode)}var e={},i={76:1,75:2,74:3,73:4,32:5,87:4,83:2,68:1,65:3};return{initialize:function(){t.initialize(),document.onkeydown=u,document.onkeyup=a},advance:function(){t.advance()}}}();return{input:n,playInput:t,setActionDelegate:t.setActionDelegate,getRootAction:t.getRootAction,advance:t.advance}}),define("kit",["require","exports","module"],function(e,t){var n=document.getElementById("kit"),r=document.getElementById("emptyKit"),i=document.getElementById("things"),s=document.getElementById("emptyThings"),o=function(e,t,n){var r=document.createElement("span"),i=document.createElement("input");i.type="checkbox",i.id="kitToggle"+e,i.value=t,i.onclick=n,i.onchange=n;var s=document.createElement("label");return s.for=i.id,s.appendChild(document.createTextNode(e)),r.appendChild(i),r.appendChild(s),r},u=function(e,t,i){var s={elementToggled:function(e){console.log("toggle"),i(this.checked)}};return s.checkbox=o(e,t,s.elementToggled),n.appendChild(s.checkbox),r.style.display="none",s},a=function(e,t){var n={elementPressed:function(e){t()}};return n.button=document.createElement("button"),n.button.innerHTML=e,n.button.onclick=n.elementPressed,i.appendChild(n.button),s.style.display="none",n},f={},l=function(e,t,n){f[e]=u(e,t,n),n(t)},c={},h=function(e,t){c[e]=a(e,t)},p=!0,d=!0;return{addToggle:l,addButton:h}}),define("dialog",[],function(){var e=document.getElementById("speech"),t=-1,n=["Hello Stranger, I am Character. Please help me escape. I will explain how. Switch the CAMERA to AUGMENTED. (Make sure you've authorized your browser to use the camera)","Please show marker #1 to the camera. You will see me through the WARPHOLE it creates.","You've found me! Hold me steady! Do do you see the SPACE SUIT on the shelf? Select the SPACE SUIT by clicking on it, then click WARPHOLE #1 and send it to me.","I see it. Please move my character onto the SPACE SUIT so that I may pick it up. WASD or IJKL will move me.","Got it. The SPACE SUIT is now part of my KIT. Click the checkbox and I'll wear it.","Oh it feels great to wear a SPACE SUIT. Please make sure I'm positioned between the tree's purple roots. Then click WARPHOLE #1 and pull me through.","Ah --- THREE SPACE. What a strange place. I'm very happy to be free of that awful pantry, thank you. Please send me through WARPHOLE #2.","Now I've warped through to a different spot on the map. Switch the CAMERA to VIRTUAL and you'll see.","Tada! I wonder, do you see where my SHADES are? Please, let's walk there and get them.","Thank you. These SHADES are very useful. They see SHADOWLAND as it is. Let's go back to that tree. Then switch the CAMERA to AUGMENTED and pull me back into THREE SPACE.","Ok, and now put me through WARPHOLE #3. We're going to try and get my KICKS back.","Tada! Set the CAMERA back to VIRTUAL and walk around until we find where my KICKS are. They are sealed in a cave by a SHADOW WALL. You'll have to use the SHADES in the SHADOWLAND to gain entry.","Very good! These KICKS are made for dancing. They've been known to work some magic. Let's put them on.","I know a simple dance, it goes like this: LEFT-LEFT-RIGHT-RIGHT-RIGHT-RIGHT-LEFT-LEFT-DOWN-DOWN.","The magic dance produced a note! Let's pick it up...","You can read the note by pushing its BUTTON in the THINGS section."];return{getMessage:function(r){r===t+1&&(t+=1,e.innerHTML=n[t])},setMessage:function(t){e.innerHTML=t}}}),define("player",["./map","./input","./kit","./inventory","./dialog"],function(e,t,n,r,i){var s=function(){var e=[],t=function(t){e.push(t)},n=function(t){e=e.filter(function(e){return e.name!==t.name})},r=function(){e.forEach(function(e){e.remove(e.getChildByName("kicks")),e.remove(e.getChildByName("shades")),e.remove(e.getChildByName("spacesuit")),e.remove(e.getChildByName("core")),e.add(c()),m&&e.add(f()),g&&e.add(l()),d.indexOf("red")>=0&&e.add(o())})};return{add:t,remove:n,rerender:r}}(),o=function(){var e=new THREE.Mesh(new THREE.CubeGeometry(1,.1,50),new THREE.MeshLambertMaterial({color:16711680,side:THREE.DoubleSide}));return e.position.set(0,.33,-25),e.name="shades",e},u=function(){var e=new THREE.MeshLambertMaterial({color:16777215,transparent:!0,opacity:0,side:THREE.DoubleSide}),t=new THREE.Mesh(new THREE.CubeGeometry(1.2,1.2,200),e);return t.name="hitbox",t},a=function(){var e=function(e,t,n,r,i){var s=function(e){var t=i?new THREE.MeshLambertMaterial({color:r,emissive:r,side:THREE.DoubleSide}):new THREE.MeshLambertMaterial({color:r,side:THREE.DoubleSide}),n=new THREE.Mesh(new THREE.CubeGeometry(e.width,e.height,e.depth),t);return n.position.set(e.x,e.y,e.z),n},o={};return o.top=s({width:e+t,height:t,depth:n,x:0,y:e/2+t/2,z:n/2}),o.right=s({width:t,height:e+2*t,depth:n,x:e/2+t/2,y:0,z:n/2}),o.left=s({width:t,height:e+2*t,depth:n,x:-e/2-t/2,y:0,z:n/2}),o.bottom=s({width:e+t,height:t,depth:n,x:0,y:-e/2-t/2,z:n/2}),o},t=new THREE.Object3D;t.name="selectionBox";var n=e(1.5,.1,.1,15793920,!0);return t.add(n.top),t.add(n.bottom),t.add(n.left),t.add(n.right),t},f=function(){var e=new THREE.MeshLambertMaterial({color:16777215,opacity:.3,transparent:!0,emissive:16777215,side:THREE.DoubleSide}),t=new THREE.Mesh(new THREE.CubeGeometry(1.2,1.2,200),e);return t.name="spacesuit",t},l=function(){var e=new THREE.Object3D,t=new THREE.MeshPhongMaterial({ambient:9127187,color:9127187,specular:9127187,shininess:50,shading:THREE.SmoothShading}),n=new THREE.Mesh(new THREE.CubeGeometry(.25,.2,50),t),r=new THREE.Mesh(new THREE.CubeGeometry(.25,.2,50),t);return n.position.set(-0.33,-0.4,-50),r.position.set(.33,-0.4,-50),e.add(n),e.add(r),e.name="kicks",e},c=function(){var e=new THREE.Mesh(new THREE.CubeGeometry(1,1,1),new THREE.MeshLambertMaterial({color:65280,emissive:65280,side:THREE.DoubleSide}));return e.name="core",e},h=function(e,t,n){var r=new THREE.Object3D;r.add(c()),m&&r.add(f()),d.indexOf("red")>=0&&r.add(o());var i=a();i.visible=!1,r.add(i);var l=u();return r.add(l),r.scale.set(t,n,.01),r.name="player_"+e,s.add(r),r.close=function(){s.remove(r)},r.setSelected=function(e){i.traverse(function(t){t.visible=e})},r.isSelected=function(){return i.visible},r.setSelected(!1),r.intersectsRay=function(e){var t=e.intersectObject(l);return t.length>0},r},p=function(e,t,n){var r=new THREE.Object3D;return r.add(u()),r.add(a()),e.name==="spacesuit"&&(r.add(f()),r.description="spacesuit"),r.scale.set(t,n,.01),r.name="inventory_"+name,r},d=["eye"],v=[],m=!1,g=!1,y=function(t){d=t===!0?["eye","red"]:["eye"],s.rerender(),e.applyFilterToMapObjects(d)},b=function(e){m=e,m&&i.getMessage(5),s.rerender()},w=function(e){g=e;if(e){i.getMessage(13);var n=t.getRootAction();n.clear(),n.add(1,["RIGHT"]),n.add(3,["LEFT","COMBO_START"]).add(3,["LEFT"]).add(1,["RIGHT"]).add(1,["RIGHT"]).add(1,["RIGHT"]).add(1,["RIGHT"]).add(3,["LEFT"]).add(3,["LEFT"]).add(2,["DOWN"]).add(2,["DOWN","COMBO_END"]),n.add(2,["DOWN"]),n.add(4,["UP"])}else{var n=t.getRootAction();n.clear(),n.add(1,["RIGHT"]),n.add(3,["LEFT"]),n.add(2,["DOWN"]),n.add(4,["UP"])}s.rerender()},E=function(){i.setMessage("The Note Reads: Hello dancer, maybe you know what to do with this: <a href='http://i.imgur.com/o70c103.png' target='_blank'>an imgur link</a>")},S=function(e){v.push(e);if(e.name==="shades"){i.getMessage(9),n.addToggle("shades",!1,y);return}if(e.name==="spacesuit"){i.getMessage(4),n.addToggle("spacesuit",!1,b);return}if(e.name==="kicks"){i.getMessage(12),n.addToggle("kicks",!1,w);return}if(e.name==="note"){i.getMessage(15),n.addButton("read note #1",E);return}},x={mapPosition:{x:26,y:32},isExtracted:!1,firePlayAction:function(t){if(x.isExtracted)return;var n={x:x.mapPosition.x,y:x.mapPosition.y};switch(t){case"RIGHT":n.x+=1;break;case"LEFT":n.x-=1;break;case"DOWN":n.y+=1;break;case"UP":n.y-=1;break;case"COMBO_START":x.comboStartPosition={x:x.mapPosition.x+1,y:x.mapPosition.y};break;case"COMBO_END":i.getMessage(14);var s=r.getItem(5);e.setItem(x.comboStartPosition,s),e.reRenderItems();break;case"EXPIRED":break;default:console.log("unknown play action:",t)}var s=e.getItem(n);s&&S(s),e.isOpenPosition(n)&&(x.mapPosition=n)},setMapPosition:function(e){x.mapPosition.x=e.x,x.mapPosition.y=e.y},addInventory:S,update:function(e){},createVirtualModel:h,createAugmentedModel:h,createInventoryModel:p,isWearingSpaceSuit:function(){return m},isWearingDanceShoes:function(){return g}};t.input.initialize(),t.playInput.initialize(),t.setActionDelegate(x);var T=t.getRootAction();return T.clear(),T.add(1,["RIGHT"]),T.add(3,["LEFT"]),T.add(2,["DOWN"]),T.add(4,["UP"]),t.playInput.enable(),x}),define("video",["./detector"],function(e){var t=function(){var e=window.URL||window.webkitURL;if(!e.createObjectURL)throw new Error("URL.createObjectURL not found.");var t=function(e,t,n){var r=undefined;return navigator.getUserMedia?r=navigator.getUserMedia(e,t,n):navigator.webkitGetUserMedia?r=navigator.webkitGetUserMedia(e,t,n):navigator.mozGetUserMedia?r=navigator.mozGetUserMedia(e,t,n):navigator.msGetUserMedia?r=navigator.msGetUserMedia(e,t,n):n(new Error("No getUserMedia implementation found.")),r},n=function(t){var n=document.querySelector("video"),r=e.createObjectURL(t);n.src=r,n.play()},r=function(e){alert("Couldn't access webcam."),console.log(e)},i=document.createElement("video");i.width=640,i.height=480,i.loop=!0,i.volume=0,i.autoplay=!0,i.controls=!0;var s=document.getElementById("subsystem");s.appendChild(i),t({video:!0},n,r);var o=document.createElement("canvas");o.width=i.width,o.height=i.width*3/4;var u=o.getContext("2d");return{canvas:o,update:function(){u.drawImage(i,0,0)}}}(),n=function(e){var t=new THREE.Camera,n=new THREE.Scene,r=new THREE.Texture(e),i=new THREE.Mesh(new THREE.PlaneGeometry(2,2,0),new THREE.MeshBasicMaterial({map:r}));return i.material.depthTest=!1,i.material.depthWrite=!1,n.add(i),{update:function(){r.needsUpdate=!0},render:function(e){e.renderer.render(n,t)}}},r=n(t.canvas);return{viewReality:r,update:function(e){t.update(),r.update()},render:function(e){r.render(e)},canvas:t.canvas}}),define("detector",["./settings","./video"],function(e,t){function a(e,t){t[0]=e.m00,t[1]=-e.m10,t[2]=e.m20,t[3]=0,t[4]=e.m01,t[5]=-e.m11,t[6]=e.m21,t[7]=0,t[8]=-e.m02,t[9]=e.m12,t[10]=-e.m22,t[11]=0,t[12]=e.m03,t[13]=-e.m13,t[14]=e.m23,t[15]=1}var n=function(){var e={width:320,height:240},t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=document.getElementById("subsystem");n.appendChild(t);var r=t.getContext("2d");r.font="24px URW Gothic L, Arial, Sans-serif";var i=new NyARRgbRaster_Canvas2D(t);return{object:i,update:function(n){r.drawImage(n,0,0,e.width,e.height),t.changed=!0}}}(),r=document.getElementById("FLARThreshold");r.onchange=function(e){m.setThreshold(this.value)};var i=e.FLARThreshold,s={width:320,height:240},o=new FLARParam(s.width,s.height),u=new FLARMultiIdMarkerDetector(o,120);u.setContinueMode(!0),THREE.Matrix4.prototype.setFromArray=function(e){return this.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])};var f=function(e){var t=new Float32Array(16);return a(e,t),t},l=function(){return s},c=function(){return u.detectMarkerLite(n.object,i)},h=function(e){var t=u.getIdMarkerData(e);if(t.packetLength>4)return-1;var n=0;for(var r=0;r<t.packetLength;r++)n=n<<8|t.getPacketData(r);return n},p=function(e,t){var n=new Float32Array(16);return o.copyCameraMatrix(n,e,t),n},d=function(e){var t=new NyARTransMatResult;return u.getTransformMatrix(e,t),f(t)},v=function(){n.update(t.canvas)},m={getMarkerNumber:h,getTransformMatrix:d,getCameraMatrix:p,getSize:l,detect:c,update:v,setThreshold:function(e){i=e}};return m}),define("virtual",["./settings","./map","./player","./detector","./hud"],function(e,t,n,r,i){var s=function(){var e={};return e.model=new THREE.Object3D,e},o=s(),u={x:22,y:22},a=350,f=t.createObject(300,300,0,u,e.worldSize.width,e.worldSize.height,n.filter);f.model.position.set(0,0,0),f.model.updateMatrix(),o.model.position.set(0,0,a),o.model.add(f.model);var l=!1,c=s(),h=n.createVirtualModel("virtual",f.tileWidth,f.tileHeight);h.targetRotation=0,c.model.position.set(0,0,a);var p=function(){var e={};e.scene=new THREE.Scene,e.scene.add(o.model),e.scene.add(c.model),e.camera=new THREE.Camera,e.cameraAltitude=-700;var s=r.getCameraMatrix(10,1e4);e.camera.projectionMatrix.setFromArray(s),e.light=new THREE.PointLight(16777215),e.light.position.set(0,0,a+100),e.camera.position.set(0,0,e.cameraAltitude),e.scene.add(e.light),e.addPlayer=function(){c.model.add(h),l=!0},e.removePlayer=function(){c.model.remove(h),l=!1};var u=new THREE.Vector3(0,0,0),p=new THREE.Vector3(0,0,0),d=function(t){var r=f.computePosition(n.mapPosition.x,n.mapPosition.y);h.position.x=r.x,h.position.y=r.y,h.position.z=r.z,h.rotation.y=h.rotation.y+=(h.targetRotation-h.rotation.y)/8;var r=f.computePosition(n.mapPosition.x,n.mapPosition.y),i=c.model.localToWorld(new THREE.Vector3(r.x,r.y,r.z));u.set(-i.x,-i.y,-a+2*e.cameraAltitude),p.set(0,0,e.cameraAltitude),e.camera.position=p,e.camera.lookAt(u)};return e.update=function(t){if(l&&n.isExtracted){e.removePlayer();return}if(n.isExtracted)return;l||e.addPlayer(),d()},e.render=function(t){t.renderer.render(e.scene,e.camera),i.positionTags(t,e.camera)},e.onMouseMove=function(e){return},e.onMouseDown=function(e){},e.onMouseUp=function(e){},e.activate=function(){i.addTag(h,"character"),f.activate(),document.getElementById("virtualCamera").style.display="block"},e.deactivate=function(){i.removeTag(h),f.deactivate(),document.getElementById("virtualCamera").style.display="none"},e.addDeltaToCameraAltitude=function(n){e.cameraAltitude+=n;var r=e.cameraAltitude>=400;t.setShadowWorld(r),h.targetRotation=r?Math.PI:0},e.addDeltaToCameraAltitude(500),e},d=p();return d.addPlayer(),{onMouseMove:function(e){return},onMouseDown:function(e){return},onMouseUp:function(e){},update:function(e){d.update(e)},render:function(e){d.render(e)},addDeltaToCameraAltitude:d.addDeltaToCameraAltitude,view:d,activate:d.activate,deactivate:d.deactivate}}),define("preload",[],function(){return{overafrica:THREE.ImageUtils.loadTexture("overafrica.png")}}),define("augmented",["./settings","./map","./player","./detector","./virtual","./inventory","./hud","./dialog","./preload"],function(e,t,n,r,i,s,o,u,a){var f=function(){var e={};return e.model=new THREE.Object3D,e.model.matrixAutoUpdate=!1,e.transform=function(t){e.model.matrix.setFromArray(t),e.model.matrixWorldNeedsUpdate=!0},e},l=function(e,t,n,r,i){var s=function(e){var t=i?new THREE.MeshLambertMaterial({color:r,emissive:r,side:THREE.DoubleSide}):new THREE.MeshLambertMaterial({color:r,side:THREE.DoubleSide}),n=new THREE.Mesh(new THREE.CubeGeometry(e.width,e.height,e.depth),t);return n.position.set(e.x,e.y,e.z),n},o={};return o.top=s({width:e+t,height:t,depth:n,x:0,y:e/2+t/2,z:n/2}),o.right=s({width:t,height:e+2*t,depth:n,x:e/2+t/2,y:0,z:n/2}),o.left=s({width:t,height:e+2*t,depth:n,x:-e/2-t/2,y:0,z:n/2}),o.bottom=s({width:e+t,height:t,depth:n,x:0,y:-e/2-t/2,z:n/2}),o},c=function(){var t=l(e.portalSize,e.frameSize,e.portalDepth,13808780,!1),n=l(e.portalSize*1.3,e.frameSize/2,.25,16776960,!0),r=new THREE.Object3D;r.add(n.top),r.add(n.bottom),r.add(n.right),r.add(n.left),r.position.set(0,0,-1),r.name="button",r.visible=!1;var i=new THREE.MeshBasicMaterial({map:a.overafrica});i.map.needsUpdate=!0;var s=new THREE.Mesh(new THREE.PlaneGeometry(e.portalSize+2,e.portalSize+2),i);s.position.set(0,0,e.portalDepth+.1);var o=new THREE.Mesh(new THREE.PlaneGeometry(e.portalSize,e.portalSize),new THREE.MeshLambertMaterial({transparent:!0,opacity:0,color:16777215,side:THREE.DoubleSide}));o.position.set(0,0,0);var u=f();return u.model.add(t.top),u.model.add(t.bottom),u.model.add(t.left),u.model.add(t.right),u.model.add(s),u.model.add(o),u.model.add(r),u.hitbox=o,u},h=function(){var t=l(e.portalSize,e.frameSize,e.portalDepth,13808780,!1),n=l(e.portalSize*1.3,e.frameSize/2,.25,16776960,!0),r=new THREE.Object3D;r.add(n.top),r.add(n.bottom),r.add(n.right),r.add(n.left),r.position.set(0,0,-1),r.name="button",r.visible=!1;var i=new THREE.Mesh(new THREE.PlaneGeometry(e.portalSize+2,e.portalSize+2),new THREE.MeshLambertMaterial({color:1118481,side:THREE.DoubleSide}));i.position.set(0,0,e.portalDepth+.1);var s=new THREE.Mesh(new THREE.PlaneGeometry(e.portalSize,e.portalSize),new THREE.MeshLambertMaterial({transparent:!0,opacity:0,color:16777215,side:THREE.DoubleSide}));s.position.set(0,0,0);var o=f();return o.model.add(t.top),o.model.add(t.bottom),o.model.add(t.left),o.model.add(t.right),o.model.add(i),o.model.add(s),o.model.add(r),o.hitbox=s,o},p=function(){var t=.5,n=function(e){var t=new THREE.Mesh(new THREE.PlaneGeometry(e.width,e.height),new THREE.MeshLambertMaterial({color:15793920,side:THREE.DoubleSide}));return t.position.set(e.x,e.y,e.z),t.rotation.y=e.ry,t.rotation.x=e.rx,t},r=n({width:e.portalSize+2*(e.frameSize+t),height:e.portalDepth,x:0,y:e.portalSize/2+e.frameSize+t,z:e.portalDepth/2,ry:0,rx:Math.PI/2}),i=n({width:e.portalSize+2*(e.frameSize+t),height:e.portalDepth,x:0,y:-(e.portalSize/2+e.frameSize+t),z:e.portalDepth/2,ry:0,rx:Math.PI/2}),s=n({width:e.portalDepth,height:e.portalSize+2*(e.frameSize+t),x:e.portalSize/2+e.frameSize+t,y:0,z:e.portalDepth/2,ry:Math.PI/2,rx:0}),o=n({width:e.portalDepth,height:e.portalSize+2*(e.frameSize+t),x:-(e.portalSize/2+e.frameSize+t),y:0,z:e.portalDepth/2,ry:Math.PI/2,rx:0}),u=f();return u.model.add(r),u.model.add(i),u.model.add(o),u.model.add(s),u},d=function(e,t,n){return n===32?v(e,t,n):m(e,t,n)},v=function(e,t,n){var r={};r.id=n,r.frame=c(),r.occluder=p(),r.transform=function(e){r.frame.transform(e),r.occluder.transform(e)},r.intersectsRay=function(e){var t=e.intersectObject(r.frame.hitbox);return t.length>0},r.setHighlight=function(e){var t=r.frame.model.getChildByName("button",!0);t.traverse(function(t){t.visible=e})};var i=function(){},s=function(){window.location="https://twitter.com/charactertravel"},o=function(e){},u=function(){},a=function(){return!1},f=function(){},l=function(){};return r.update=function(e){},r.close=function(){},r.containsPlayerMapPosition=function(){return!1},r.addToScene=function(e,t){e.add(r.frame.model),t.add(r.occluder.model)},r.removeFromScene=function(e,t){e.remove(r.frame.model),t.remove(r.occluder.model)},r.insertPlayer=s,r.removePlayer=l,r.insertItem=o,r.extractItem=u,r.playerIsInChamber=a,r},m=function(r,i,s){var o={};o.id=s,o.frame=h(),o.occluder=p(),o.mapContainer=f();var a=t.createObject(r,i,e.portalDepth,t.WarpHolePoints[s],e.warpHoleColumns,e.warpHoleRows,n.filter);o.mapContainer.model.add(a.model),a.activate();var l=!1;o.playerContainer=f();var c=n.createVirtualModel("warphole"+s,a.tileWidth,a.tileHeight);o.transform=function(e){o.mapContainer.transform(e),o.frame.transform(e),o.playerContainer.transform(e),o.occluder.transform(e)},o.intersectsRay=function(e){var t=e.intersectObject(o.frame.hitbox);return t.length>0},o.setHighlight=function(e){var t=o.frame.model.getChildByName("button",!0);t.traverse(function(t){t.visible=e})};var d=function(){if(!l)return;u.getMessage(2);var e=a.computePosition(n.mapPosition.x,n.mapPosition.y);c.position.x=e.x,c.position.y=e.y,c.position.z=e.z,c.__dirtyPosition=!0,c.updateMatrixWorld()},v=function(){o.id===8&&u.getMessage(7),o.id===4&&u.getMessage(11),b(),n.setMapPosition(t.WarpHolePoints[o.id])},m=function(e){u.getMessage(3),t.setItem(t.WarpHolePoints[o.id],e),t.reRenderItems()},g=function(){var e=t.getItem(t.WarpHolePoints[o.id]);return e},y=function(){return t.WarpHolePoints[s].x===n.mapPosition.x&&t.WarpHolePoints[s].y===n.mapPosition.y},b=function(){o.playerContainer.model.add(c),l=!0},w=function(){o.playerContainer.model.remove(c),l=!1};return o.update=function(e){if(l){if(n.isExtracted){w();return}if(!o.containsPlayerMapPosition()){w();return}}if(n.isExtracted)return;!l&&o.containsPlayerMapPosition()&&b(),d()},o.close=function(){c.close(),a.close()},o.containsPlayerMapPosition=function(){return a.containsPoint(n.mapPosition)},o.addToScene=function(e,t){e.add(o.frame.model),e.add(o.mapContainer.model),e.add(o.playerContainer.model),t.add(o.occluder.model)},o.removeFromScene=function(e,t){e.remove(o.frame.model),e.remove(o.mapContainer.model),e.remove(o.playerContainer.model),t.remove(o.occluder.model)},o.insertPlayer=v,o.removePlayer=w,o.insertItem=m,o.extractItem=g,o.playerIsInChamber=y,o},g=function(e,t){var n=t.getChildByName("hitbox"),r=t.getChildByName("selectionBox"),i=function(e){var t=e.intersectObject(n);return t.length>0},s=function(e){r.traverse(function(t){t.visible=e})},o=function(){return r.visible};s(!1);var u={item:e,model:t,setSelected:s,isSelected:o,intersectsRay:i};return u},y=function(){var e=new THREE.Scene,t=new THREE.Scene,i=10,a=new THREE.Camera,f=r.getCameraMatrix(10,1e4);a.projectionMatrix.setFromArray(f);var l=[],c=!1,h=n.createAugmentedModel("extracted",i,i),p=s.getItem(3),v=n.createInventoryModel(p,i,i),m=g(p,v),y=[],b=function(t){l.push(t),y.push(t.model),e.add(t.model)},E=function(t){l=l.filter(function(e){e!==t}),y=y.filter(function(e){return e.name==t.model.name?(o.removeTag(e),!1):!0}),e.remove(t.model)};b(m);var S=function(){if(!c)return;var e=M.position.clone();e.y+=i/2+2,h.position.x=e.x,h.position.y=e.y,h.position.z=e.z,h.rotation.y+=Math.PI/360,h.__dirtyPosition=!0,h.updateMatrixWorld()},x=function(){var e=O.position.clone();e.x-=L/2-i/2-5,e.y+=i/2+2,v.position.x=e.x,v.position.y=e.y,v.position.z=e.z,v.rotation.y+=Math.PI/360,v.__dirtyPosition=!0,v.updateMatrixWorld()},T=function(){u.getMessage(6),u.getMessage(10),e.add(h),c=!0,n.isExtracted=!0},N=function(){e.remove(h),c=!1,n.isExtracted=!1},C=function(e){var t=!1;l.forEach(function(n){n.isSelected()&&(e.insertItem(n.item),E(n),t=!0)});if(t)return;var r=e.extractItem();if(r){m=g(r,v),b(m);return}c&&n.isWearingSpaceSuit()?(e.insertPlayer(),N()):e.playerIsInChamber()&&n.isWearingSpaceSuit()&&(u.getMessage(6),e.removePlayer(),T())},k=function(){var e=new THREE.Mesh(new THREE.CubeGeometry(20,2.5,50),new THREE.MeshLambertMaterial({color:3100495,side:THREE.DoubleSide}));return e},L=70,A=function(){var e=new THREE.Mesh(new THREE.CubeGeometry(L,2.5,50),new THREE.MeshLambertMaterial({color:3100495,side:THREE.DoubleSide}));return e},O=A();O.position.set(12,-35,250),e.add(O);var M=k();M.position.set(-38,-35,250),e.add(M);var _=new THREE.PointLight(13421772);_.position.set(0,-400,800),e.add(_);var D=new THREE.PointLight(13421772);D.position.set(0,0,2500),e.add(D);var P={},H=new THREE.Projector,B=function(e,t,n){var r=3;for(var i=0;i<e.length;i++)t[i]+=(e[i]-t[i])/r;return t},j=function(e){var t=r.detect();for(var n=0;n<t;n++){var i=r.getMarkerNumber(n),s=P[i],o=r.getTransformMatrix(n);s||(s=d(100,100,i),s.filtered=new Float32Array(16),s.filtered.set(o),F(s)),s.age=0,s.transformMatrix=o}for(var u in P){var s=P[u];if(s.age>1)I(s);else{s.age++;var a=B(s.transformMatrix,s.filtered,e);s.update(e),s.transform(a)}}},F=function(n){P[n.id]=n,n.addToScene(e,t)},I=function(n){n.close(),n.removeFromScene(e,t),delete P[n.id]},q=function(e){var t=e.clone();H.unprojectVector(t,a);var n=new THREE.Raycaster(a.position,t.sub(a.position).normalize());for(var r in P){var i=P[r],s=i.intersectsRay(n);i.setHighlight(s)}};return{checkIntersection:function(e){H.unprojectVector(e,a);var t=new THREE.Raycaster(a.position,e.sub(a.position).normalize());for(var n in P){var r=P[n];r.intersectsRay(t)&&C(r)}h.intersectsRay(t)&&h.setSelected(!h.isSelected()),l.forEach(function(e){e.intersectsRay(t)&&(u.getMessage(2),e.setSelected(!e.isSelected()))})},addPlayer:T,removePlayer:N,update:function(e){S(),x(),r.update(),j(e),q(w)},render:function(n){n.beginOccluderRendering(),n.renderer.render(t,a),n.endOccluderRendering(),n.renderer.render(e,a),o.positionTags(n,a)},activate:function(){y.forEach(function(e){o.addTag(e,e.description)}),document.getElementById("augmentedCamera").style.display="block"},deactivate:function(){y.forEach(function(e){o.removeTag(e)}),document.getElementById("augmentedCamera").style.display="none"}}},b=y(),w=new THREE.Vector3(0,0,0);return{onMouseMove:function(e){w=e},onMouseDown:function(e){b.checkIntersection(e)},onMouseUp:function(e){},update:function(e){b.update(e)},render:function(e){b.render(e)},activate:b.activate,deactivate:b.deactivate}}),define("profiler",["./detector"],function(e){var t=new Stats;t.setMode(0),t.domElement.style.position="absolute",t.domElement.style.zIndex="1000",t.domElement.style.left="0px",t.domElement.style.top="0px",document.body.appendChild(t.domElement);if(DEBUG){var n=document.createElement("canvas");n.id="debugCanvas",n.width=e.getSize().width+1,n.height=e.getSize().height,document.getElementById("subsystem").appendChild(n)}return{startSample:t.begin,endSample:t.end}}),define("earth",["domReady!"],function(e){var t=document.getElementById("googleMap"),n=function(e){t.style.visibility=e?"visible":"hidden"};if(typeof google!="object"||typeof google.maps!="object")return console.log("Failed to load google maps api. Maps will not work."),{activate:function(){n(!0)},deactivate:function(){n(!1)}};var r={center:new google.maps.LatLng(-34.397,150.644),zoom:1,mapTypeId:google.maps.MapTypeId.ROADMAP},i=new google.maps.Map(document.getElementById("googleMap"),r),s=new google.maps.LatLng(37.554,126.924),o=new google.maps.Marker({position:s,map:i,title:"here a sign says 'TORONTO'"}),u=new google.maps.LatLng(22.211,114.029),o=new google.maps.Marker({position:u,map:i,title:"on an island of an island city"}),a=new google.maps.LatLng(-32.079,19.089),o=new google.maps.Marker({position:a,map:i,title:"the San were here"});return{activate:function(){n(!0)},deactivate:function(){n(!1)}}}),requirejs(["./settings","./display","./player","./augmented","./virtual","./video","./profiler","./earth","./input","./dialog"],function(e,t,n,r,i,s,o,u,a,f){console.log("IMPORTANT: Firefox Aurora users: set media.navigator.enabled to TRUE in about:config");var l=function(){var e=[],o=0,l=undefined,c=undefined,h=function(e,t,n,r){var i=document.createElement("span"),s=document.createElement("input");s.type="radio",s.id="radio"+t,s.name=e,s.value=t,s.checked=r,s.onclick=n;var o=document.createElement("label");return o.for=s.id,o.appendChild(document.createTextNode(t)),i.appendChild(s),i.appendChild(o),i},p=function(){var e=h("mode","virtual",g,!0),t=h("mode","augmented",m,!1),n=h("mode","earth",y,!1);document.getElementById("controls").appendChild(e),document.getElementById("controls").appendChild(t),document.getElementById("controls").appendChild(n),document.getElementById("raiseVirtualCamera").onclick=function(e){i.addDeltaToCameraAltitude(-100)},document.getElementById("lowerVirtualCamera").onclick=function(e){i.addDeltaToCameraAltitude(100)}},d=undefined,v=function(e){d&&d.deactivate(),d=e,e.activate()},m=function(){v(r),l=b,c=w,t.mouseListener=r,f.getMessage(1)},g=function(){v(i),l=E,c=S,t.mouseListener=i,f.getMessage(8)},y=function(){v(u)},b=function(e){s.update(e),r.update(e)},w=function(){t.renderer.clear(),s.render(t),r.render(t)},E=function(e){i.update(e)},S=function(){t.renderer.clear(),i.render(t)},x=function(){c()},T=function(e){a.advance(),n.update(e),l(e)};return t.mouseListener=this,p(),g(),f.getMessage(0),{render:x,update:T}}(),c=function(e){requestAnimationFrame(c),o.startSample(),l.update(e),l.render(),o.endSample()};c()}),define("application",function(){});